---
# SPDX-License-Identifier: EUPL-1.2
# SPDX-FileCopyrightText: 2025-present JÃ¼rgen MÃ¼lbert <juergen.muelbert@gmail.com>
#
name: âš™ï¸ Code Quality (MegaLinter)

# yamllint disable-line rule:truthy
on:
  push:
    # Runs on every push to the main branches
    branches: [main, master]
  pull_request:
    # Runs on every pull request
    branches: [main, master]

jobs:
  megalinter:
    name: ğŸ“Š Linting
    runs-on: ubuntu-latest

    # Give the default GITHUB_TOKEN read permission only
    # (Since we aren't auto-committing fixes, we don't need 'write')
    permissions:
      contents: read

    steps:
      - name: ğŸ”’ Harden Runner
        uses: step-security/harden-runner@f4a75cfd619ee5ce8d5b864b0d183aff3c69b55a # v2.13.1
        with:
          egress-policy: audit

      - name: ğŸ§° Checkout Repository
        uses: actions/checkout@93cb6efe18208431cddfb8368fd83d5badbf9bfd # v5.0.1
        with:
          fetch-depth: 0

      - name: ğŸ”„  Run MegaLinter
        # Use a fixed, stable version (v8 is current, or v7 if you prefer)
        uses: oxsecurity/megalinter@55a59b24a441e0e1943080d4a512d827710d4a9d # v9
        env:
          # --- Essential Configuration ---
          # 1. Provide the necessary token
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

          # 2. Tell MegaLinter to run on the entire checked-out codebase
          # This is simpler and more reliable than running on diffs.
          VALIDATE_ALL_CODEBASE: true

          # 3. Disable the Fixes (Crucial for simplicity and security)
          APPLY_FIXES: none
